# GWAS

Je dacht misschien dat we er na de kwaliteitscontrole al waren, maar helaas. We moeten nog een paar voorbereidende stappen doen. Dit is gelukkig veel minder dan de kwaliteitscontrole zelf, dus hier zijn we veel sneller doorheen.

Daarna gaan we wel echt de GWAS uitvoeren. Deze neemt behoorlijk wat tijd in beslag, dus zet hem vooral op de snelste computer zo snel mogelijk aan en ga in de tussentijd dan andere dingen doen.

## Inhoud
1. GWAS-voorbereidingen
  * Fenotype QC
  * Covariaten
2. GWAS

## GWAS-voorbereidingen
### Fenotype QC
Normaalgesproken moeten we bij deze stap eerst nog bedenken hoe we ons fenotype (de ziekte, eigenschap die getest wordt) precies beschrijven. Bij een fenotype als hartfalen is dat (afhankelijk van de database die gebruikt wordt) redelijk eenvoudig, omdat dit gediagnosticeerd wordt door cardiologen. In ons geval is dit voor jullie dus al gedaan door de arts en je ziet het terug in zowel de eerste als laatste kolom van de fam-bestanden.

Voor de controle-groep moet er nog wel iets gebeuren. Deze mensen zijn niet specifiek voor deze studie opgeroepen en er zitten daardoor mensen tussen die hartklachten hebben. Dat willen we niet, dus deze mensen moeten er ook nog uit.
1. Open het fenotype-bestand dat je van mij gekregen hebt in excel, deze is al gefilterd voor alleen de controles die in jullie dataset zitten
2. Maak een nieuwe kolom aan (`fenotype` bijvoorbeeld)
3. Maak een `ALS`-formule aan die aan de volgende zin voldoet:
  * Als deze persoon last van hartklachten heeft, maak deze cel `-9`, anders `1`
4. Open ook het laatste fam-bestand in excel
  * Mocht dit niet direct lukken vanwege de extensie, verander dan de extensie tijdelijk naar txt
5. Zorg ervoor dat de volgorde van je fenotype-bestand hetzelfde is als die van het fam-bestand
6. Kopieer nu de laatste kolom (excl. header) van het fenotype-bestand en vervang de laatste kolom van het fam-bestand hiermee
7. Sla alles op (denk aan de fam-extensie!)

### Covariaten
Risicofactoren zijn factoren waarbij het risico van deze patient om hartfalen te krijgen, hoger wordt. Gewicht is natuurlijk een hele bekende. Iemand die zwaarder is, loopt meer risico op allerlei ziekten en dus ook hartfalen.
> Q1. Bedenk ook met behulp van literatuur wat risicofactoren kunnen zijn voor hartfalen.

Als wij een GWAS uitvoeren kijken we dus of er een relatie (associatie) is tussen het hebben van een bepaald genotype en hartfalen. Hoe ouder iemand is, hoe meer kans iemand heeft op hartfalen, ongeacht genotype. Leeftijd is dus sowieso een risicofactor en leeftijd is niet genetisch bepaald (iedereen wordt met dezelfde snelheid ouder in principe). Zo ook met geslacht. Dit zijn daarom twee risicofactoren waar we vaak voor corrigeren. De risicofactoren waar we voor corrigeren noemen we dan covariaten. Corrigeren houdt in dat we kijken of er een verband bestaat tussen geno- en fenotype als de covariaat gelijk gehouden wordt.

Om te kunnen corrigeren voor leeftijd en geslacht, moeten we dit wel weten natuurlijk. Daarom maken we naast de genotype-bestanden (de bestanden waar je tot nu toe mee gewerkt hebt) ook altijd nog fenotype-bestanden. Hier is dus informatie in opgeslagen zoals leeftijd, geslacht en soms nog veel meer variabelen, zoals BMI, bloeddruk en of mensen bepaalde ziektes hebben of niet.

De fenotype-bestanden (`example.mds` en `HF_feno.tsv`) zijn al gefilterd voor de individuen die niet door de kwaliteitscontrole heen kwamen. Open `HF_feno.tsv` in excel. Zoals je ziet zijn er nog wat missende waardes voor leeftijd. Deze mensen kunnen we niet meenemen in de analyse. Lees de informatie op de website van plink over het bestand met de [covariaten](http://zzz.bwh.harvard.edu/plink/data.shtml#covar).

> Q2. Moeten we de mensen met missende waardes voor leeftijd verwijderen? Zo niet, waarom niet?

Andere covariaten waar we voor willen corrigeren staan in het tweede bestand `example.mds`. Dit is het resultaat van de analyse naar ethniciteit. We hebben daar de meest afwijkende mensen al wel verwijderd, maar we corrigeren voor de achtergebleven variatie door deze variabelen ook mee te nemen.

1. Open beide bestanden in excel en voeg ze samen, zodat de eerste twee kolommen de IDs zijn en daarna de kolommen volgen met de overige covariaten
2. Sla het bestand als txt-bestand op met een duidelijk herkenbare naam

> Q3. Welke optie in plink kunnen we gebruiken, zodat het covariaten-bestand meegenomen wordt in de analyse?

## GWAS

De tijd van GWAS is aangebroken. Lees eerst de instructies op de website van plink, onder de subkopjes `Basic usage` en `Covariate and interactions` van het kopje [Linear and logistic models](http://zzz.bwh.harvard.edu/plink/anal.shtml#glm). Probeer aan de hand van deze informatie en onderstaande aanwijzingen het commando samen te stellen voor de GWAS in plink:
* Ons fenotype is een ziekte (een binaire variabele)
* We willen ook kolommen met 95% confidence interval
* We gaan uit van een additive effect (elk risico-allel dat iemand draagt verhoogt het risico voor die persoon een beetje)
* We hebben een covariatenbestand, waaarin alle kolommen gebruikt mogen worden
* We willen zo min mogelijk rijen per SNP (zie HINT)

> Q4. Waarom hoeft geslacht niet per se in het covariatenbestand toegevoegd te worden?

> Q5. Schrijf het commando uit en vraag om hulp.
